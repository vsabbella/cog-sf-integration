/**
 * Created by venkatasabbella on 1/27/24.
 */

@isTest(SeeAllData=false)
private with sharing class CognisureAPIConsumerCtrlTest {

    private static testMethod void permissonsTest() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            String SObjectTypeStr = 'Case';
            Schema.DescribeSObjectResult[] descResult_Case = Schema.describeSObjects(new List<String>{
                    SObjectTypeStr
            });
            Schema.DescribeSObjectResult descRes = descResult_Case[0].getSObjectType().getDescribe();
            if (descResult_Case[0].isAccessible() && descResult_Case[0].isQueryable()) {

            } else {
                System.assert(false, 'Case field on Submission object is not accessible. Check Permissions.');
            }
        }
        Test.stopTest();

    }

    private static testMethod void TestUploadPIRequests() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            Sobject s = Cognisureapi__mdt.getInstance('api_details');
            System.assert(s != null, 'cognisureapimetadata is not found.');
            Case case0 = [select Id from case order by createdDate desc limit 1];
            CognisureAPIConsumerCtrl c = new CognisureAPIConsumerCtrl();
            c.makeUploadRequestdo(case0.Id);
        }
        Test.stopTest();

    }

    private static testMethod void testCSFileUPloadBatch() {


        Id jobId ;
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            CSFileUploadAPIConsumerBatch c = new CSFileUploadAPIConsumerBatch();
            jobId = Database.executeBatch(c, 1);
        }
        Test.stopTest();

        AsyncApexJob a = [Select Id, Status, ExtendedStatus, NumberOfErrors from AsyncApexJob where Id = :jobId];
        System.debug(LoggingLevel.DEBUG, 'AsyncApexJob' + a);
        Submission__c sub = [Select Id, name, Message_Id__c, Common_JSON_Status__c, Custom_JSON_Status__c, Submission_360_Status__c from Submission__c limit 1];
        system.assert(sub != null, 'Submission is null');
        //system.assert(sub.Message_Id__c!=null, 'Submission is null');
    }

    private static testMethod void testCSSubmissionBatch() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        List<Claim> claims = [Select Id, name from Claim];
        system.assert(claims.size() == 0, 'Claims should not exist');
        Id jobId ;
        String respId = getMessageIdfromCSResponse();
        Submission__c s = [Select Id, name, Message_Id__c, Common_JSON_Status__c, processed_commonjson__c from Submission__c limit 1];
        s.Message_Id__c = respId;
        s.Common_JSON_Status__c = true;
        s.processed_commonjson__c = false;
        Update s;

        Test.startTest();
        System.runAs(u) {
            try {
                cssubmissionbatch c = new cssubmissionbatch();
                //jobId = Database.executeBatch(c, 1);
            } catch (Exception ex) {

            }

        }
        Test.stopTest();


        /*AsyncApexJob a = [Select Id, Status, ExtendedStatus, NumberOfErrors from AsyncApexJob where Id = :jobId];
        System.assert(a.Status == 'Completed', 'AsyncApexJob' + a);
        System.assert(a.NumberOfErrors == 0, 'AsyncApexJob' + a);
        Submission__c sub = [Select Id, name, Message_Id__c, Common_JSON_Status__c, Custom_JSON_Status__c, Submission_360_Status__c from Submission__c limit 1];
        system.assert(sub != null, 'Submission is null');
        system.assert(sub.Message_Id__c != null, 'Submission is null');

        claims = [Select Id, name from Claim];
        system.assert(claims.size() > 0, 'Claims are not generated');
        system.debug(LoggingLevel.DEBUG, '' + claims);*/

    }

    private static void uploadFilesAPITest() {

        Id caseId = '500DS00000FUYyuYAH';
        String ctoken2 = 'VKNRwDT8MMWOsdb1gTZRWQPn1YFxxs2SlELG_BT8il3G1q4-4C3a6xQDb3lR2awu3KqhG6XMOPiWEoSuzXo8ldJJySnjxVgPP-djywmn_J7TbDzuXiW1oY_qnwWTIZfj07TtI-DWszip934wVjywHzI92Wh2YM2r8jzcUOBWtDJBlytK9wfjJjxAnX6eb9_2LMHxouM4zyGWFAE5-VaYrR1cH6-g0Y82pOEmt5JdZOxDTlaHhSGGcVnWyyxB-Vur';
        Cognisureapi__mdt cognisureapimetadata = Cognisureapi__mdt.getInstance('api_details');
        String baseURL = (String) cognisureapimetadata.get('Base_URL__c');
        //String contentPlugin = (String) cognisureapimetadata.get('File_Content_Plugin__c');
        //String fileQueryClass = string.isBlank(contentPlugin) ? 'CognisureAPI.AttachmentQuery' : contentPlugin;
        //CognisureAPI.IFileContentQueryHander fileQueryHandler = (CognisureAPI.IFileContentQueryHander) Type.forName(fileQueryClass).newInstance();
        //String fileQueryString = fileQueryHandler.getFileContentQuery(caseId);
        //String form64='';
        //form64 += CognisureAPI_Util.getBase64String(caseId, fileQueryString);
        String form64Str = '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';

        string contentType = vNHttpFormBuilder.GetContentType();

        blob formBlob = EncodingUtil.base64Decode(form64Str);
        string contentLength = string.valueOf(formBlob.size());

        //  Compose the http request
        HttpRequest httpRequest = new HttpRequest();

        httpRequest.setHeader('Authorization', 'Bearer ' + ctoken2);

        //httpRequest.setBody(emailbodyjson);
        String uploadAPIUrlformatted = String.format((String) cognisureapimetadata.get('Upload_API_Endpoint__c'), new List<String>{
                '', caseId, caseId
        });
        //string namedCredendpoint = 'callout:'+this.NamedCredentail+uploadAPIUrlStr;
        //string namedCredendpoint_2 = 'callout:csfileupload'+uploadAPIUrlStr;
        //System.debug(LoggingLevel.DEBUG,namedCredendpoint);
        String endpoint = baseurl + uploadAPIUrlformatted;
        httpRequest.setEndpoint(endpoint);
        httpRequest.setBodyAsBlob(formBlob);
        httpRequest.setHeader('Connection', 'keep-alive');
        httpRequest.setHeader('Content-Length', contentLength);
        httpRequest.setHeader('Content-Type', contentType);
        httpRequest.setMethod('POST');
        httpRequest.setTimeout(120000);

        if (test.isRunningTest())
            Test.setMock(HttpCalloutMock.class, new CognisureFileUploadMockImpl());

        Http http = new Http();
        HTTPResponse res = http.send(httpRequest);

        string responseStatusCode = String.valueof(res.getStatusCode());
        string responseBody = String.valueof(res.getbody());

        //Expected response
        //"{\"id\":null,\"returnCode\":false,\"message\":\"Please upload valid files\",\"fileUploadResults\":[]}"

    }

    private static String getBase64String() {
        return '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';
    }

    private static testMethod void TestCommonJSONResponse() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            Sobject s = Cognisureapi__mdt.getInstance('api_details');
            System.assert(s != null, 'cognisureapimetadata is not found.');
            Case case0 = [select Id from case limit 1];
            CognisureAPIConsumerCtrl c = new CognisureAPIConsumerCtrl();
            c.getCommonJSONforSubmission(case0.Id);
        }
        Test.stopTest();


    }

    private static testMethod void TestCommonJSONResponse2() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            Sobject s = Cognisureapi__mdt.getInstance('api_details');
            System.assert(s != null, 'cognisureapimetadata is not found.');
            for (Case case0 : [select Id from case where createdDate = Today limit 1]) {
                CognisureAPIConsumerCtrl c = new CognisureAPIConsumerCtrl();
                c.getCommonJSONforSubmission(case0.Id);

            }
        }
        Test.stopTest();
    }

    private static testMethod void TestScheduler() {
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            CognisureAPIConsumerScheduler schInstance = new CognisureAPIConsumerScheduler();
            String sch = '0 48 * * * ?';
            System.schedule('Scheduler of API batches', sch, schInstance);
        }
        Test.stopTest();


    }

    private static testMethod void test_ProcessJSONResponseFromStaticResource() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            try {
                CognisureAPIRequestsTest.test_ProcessJSONResponseFromStaticResource();
            } catch (Exception Ex) {

            }
        }
        Test.stopTest();
    }

    private static testMethod void testJsonResponse_passwith1RecordEach() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            String jsonResponse = CommonJSONResponseTestData.getCommonjsonAPIResp_passwith1recordeach();
            List<Submission__c> submisstionList = [Select Id, name, case__c from Submission__c limit 1];
            System.assert(submisstionList.size() > 0, 'Submission Record Does not Exist');
            String SubmisisonId = submisstionList[0].Id;
            System.assert(submisstionList[0].case__c != null, 'Submission case Does not Exist');

            List<StaticResource> sr = [Select id, name, body from StaticResource where Name = 'submissionrespunformatted'];
            System.assert(sr.size() > 0, 'Static Resource is not available');
            String submissionResponseJson = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr[0].body)).toString();
            System.assert(!String.isBlank(submissionResponseJson), 'JSON Response is blank');

            try {
                ProcessSubmissionResponse.processJSONResponse(jsonResponse, SubmisisonId);
            } catch (Exception Ex) {
                System.debug(LoggingLevel.ERROR, ex.getMessage() + ex.getCause());
                System.assert(false, 'Error:' + Ex.getCause() + Ex.getMessage());
            }

        }
        Test.stopTest();

        List<Account> AcctList = [Select Id, name, RecordTypeId from Account where createdDate = Today];
        System.assert(AcctList.size() == 1, 'Account Not created');
        System.Debug(LoggingLevel.DEBUG, 'Accounts:' + JSON.serialize(AcctList));


        List<Claim> Claims = [Select Id, Name, AccountId, IsDrivable, Status from Claim where createdDate = Today];
        System.assert(Claims.size() == 1, 'Claims Not created');
        System.Debug(LoggingLevel.DEBUG, 'Claims:' + JSON.serialize(Claims));

        List<CustomerProperty> CustomerProperties = [
                Select Id, PrimaryOwnerId, FloorType, FoundationType, GarageType,
                        LotArea, CeilingType, DwellingType, PurchasePrice, RoofType, BedroomCount, BuiltUpArea, EngineDisplacementVolume, FairMarketValue, FloorCount, IsBasementIncluded,
                        IsChimneyIncluded, IsPassedSmogCheck, IsSwimmingPoolIncluded, PurchaseDate, YearBuilt
                from CustomerProperty
                where createdDate = Today
        ];
        System.assert(CustomerProperties.size() == 1, 'CustomerProperties Not created');
        System.Debug(LoggingLevel.DEBUG, 'CustomerProperties:' + JSON.serialize(CustomerProperties));


        List<CoverageType> CoverageTypes = [
                Select Id, Category, CategoryGroup, CategoryGroupType, CategoryGroupTypeValue, DeductibleAmount, EffectiveDate, ExpirationDate, LimitAmount, LimitRange, Name, SourceSystemIdentifier
                from CoverageType
                where createdDate = Today
        ];
        System.assert(CoverageTypes.size() > 0, 'CoverageTypes Not created');
        System.Debug(LoggingLevel.DEBUG, 'CoverageTypes:' + JSON.serialize(CoverageTypes));

        List<InsurancePolicy> InsurancePolicies = [
                Select Id, Name
                from InsurancePolicy
                where createdDate = Today
        ];
        //System.assert(InsurancePolicies.size()>0, 'InsurancePolicies Not created');
        System.Debug(LoggingLevel.DEBUG, 'InsurancePolicies:' + JSON.serialize(InsurancePolicies));


    }

    private static testMethod void testJsonResponse_2Accounts_2Claims() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        String jsonResponse = CommonJSONResponseTestData.getCommonjsonAPIResp_MulitpleRecords();
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            List<Submission__c> submisstionList = [Select Id, name, case__c from Submission__c limit 1];
            System.assert(submisstionList.size() > 0, 'Submission Record Does not Exist');
            String SubmisisonId = submisstionList[0].Id;
            System.assert(submisstionList[0].case__c != null, 'Submission case Does not Exist');
            List<StaticResource> sr = [Select id, name, body from StaticResource where Name = 'submissionrespunformatted'];
            System.assert(sr.size() > 0, 'Static Resource is not available');
            String submissionResponseJson = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr[0].body)).toString();
            System.assert(!String.isBlank(submissionResponseJson), 'JSON Response is blank');

            try {
                ProcessSubmissionResponse.processJSONResponse(jsonResponse, SubmisisonId);
            } catch (Exception Ex) {
                System.debug(LoggingLevel.ERROR, ex.getMessage() + ex.getCause());
                System.assert(false, 'Error:' + Ex.getCause() + Ex.getMessage());
            }
            List<Account> AcctList = [Select Id, name, RecordTypeId from Account where createdDate = Today];
            System.assert(AcctList.size() == 1, 'Account Not created');
            System.Debug(LoggingLevel.DEBUG, 'Accounts:' + JSON.serialize(AcctList));


            List<Claim> Claims = [Select Id, Name, AccountId, IsDrivable, Status, Cause_Of_Loss__c from Claim where createdDate = Today];
            System.assert(Claims.size() == 2, 'Claims Not created');
            System.Debug(LoggingLevel.DEBUG, 'Claims:' + JSON.serialize(Claims));
            Set<String> strCauseOfLossSet = new Set<String>{
                    'PROPERTYDAMAGE', 'THEFT'
            };
            strCauseOfLossSet.contains(Claims[0].Cause_Of_Loss__c);
            strCauseOfLossSet.contains(Claims[1].Cause_Of_Loss__c);


            List<CustomerProperty> CustomerProperties = [
                    Select Id, PrimaryOwnerId, FloorType, FoundationType, GarageType,
                            LotArea, CeilingType, DwellingType, PurchasePrice, RoofType, BedroomCount, BuiltUpArea, EngineDisplacementVolume, FairMarketValue, FloorCount, IsBasementIncluded,
                            IsChimneyIncluded, IsPassedSmogCheck, IsSwimmingPoolIncluded, PurchaseDate, YearBuilt
                    from CustomerProperty
                    where createdDate = Today
            ];
            System.assert(CustomerProperties.size() == 1, 'CustomerProperties Not created');
            System.Debug(LoggingLevel.DEBUG, 'CustomerProperties:' + JSON.serialize(CustomerProperties));


            List<CoverageType> CoverageTypes = [
                    Select Id, Category, CategoryGroup, CategoryGroupType, CategoryGroupTypeValue, DeductibleAmount, EffectiveDate, ExpirationDate, LimitAmount, LimitRange, Name, SourceSystemIdentifier
                    from CoverageType
                    where createdDate = Today
            ];
            System.assert(CoverageTypes.size() > 0, 'CoverageTypes Not created');
            System.Debug(LoggingLevel.DEBUG, 'CoverageTypes:' + JSON.serialize(CoverageTypes));

            List<InsurancePolicy> InsurancePolicies = [
                    Select Id, Name
                    from InsurancePolicy
                    where createdDate = Today
            ];
            //System.assert(InsurancePolicies.size()>0, 'InsurancePolicies Not created');
            System.Debug(LoggingLevel.DEBUG, 'InsurancePolicies:' + JSON.serialize(InsurancePolicies));
        }
        Test.stopTest();


    }

    private static testMethod void Test_EmptyclaimName_EmptyAccountName() {
        String jsonResponse = CommonJSONResponseTestData.getCommonjsonAPIResp_EmptyclaimName_EmptyAccountName();
        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            List<Submission__c> submisstionList = [Select Id, name, case__c from Submission__c limit 1];
            Cognisureapi__mdt apimdt = Cognisureapi__mdt.getInstance('api_details');
            System.assert(apimdt != null, 'Cognisure metadata is not available');
            System.assert((String) apimdt.get('Field_Default_Definition__c') != null, 'Cognisure Static Resource Default  definition is not available');
            System.assert(submisstionList.size() > 0, 'Submission Record Does not Exist');
            String SubmisisonId = submisstionList[0].Id;
            System.assert(submisstionList[0].case__c != null, 'Submission case Does not Exist');

            List<StaticResource> sr = [Select id, name, body from StaticResource where Name = 'submissionrespunformatted'];
            System.assert(sr.size() > 0, 'Static Resource is not available');
            String submissionResponseJson = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr[0].body)).toString();
            System.assert(!String.isBlank(submissionResponseJson), 'JSON Response is blank');

            List<StaticResource> srList = [Select Id, name, body from StaticResource where Name = 'cognisure_sffield_defaults'];
            System.assert(srList.size() > 0, 'Static Resource is not available');
            String submissionResponseJson2 = EncodingUtil.base64Decode(EncodingUtil.base64Encode(srList[0].body)).toString();
            System.assert(!String.isBlank(submissionResponseJson2), 'JSON Response is blank');

            try {
                ProcessSubmissionResponse.processJSONResponse(jsonResponse, SubmisisonId);
            } catch (Exception Ex) {
                System.debug(LoggingLevel.ERROR, ex.getMessage() + ex.getCause());
                System.assert(false, 'Error:' + Ex.getCause() + Ex.getMessage());
            }

        }
        Test.stopTest();


        List<Account> AcctList = [Select Id, name, RecordTypeId from Account where createdDate = Today];
        System.assert(AcctList.size() == 1, 'Account Not created');
        System.Debug(LoggingLevel.DEBUG, 'Accounts:' + JSON.serialize(AcctList));
        System.assert(AcctList[0].Name == 'Cognisure Test Account', 'Account Default Name is Not Correct ' + AcctList[0].Name);


        List<Claim> Claims = [Select Id, Name, AccountId, IsDrivable, Status from Claim where createdDate = Today];
        System.assert(Claims.size() == 1, 'Claims Not created');
        System.Debug(LoggingLevel.DEBUG, 'Claims:' + JSON.serialize(Claims));
        System.assert(Claims[0].Name == 'Cognisure Default', 'Claim Default Name is Not Correct ' + Claims[0].Name);

        List<CustomerProperty> CustomerProperties = [
                Select Id, PrimaryOwnerId, FloorType, FoundationType, GarageType,
                        LotArea, CeilingType, DwellingType, PurchasePrice, RoofType, BedroomCount, BuiltUpArea, EngineDisplacementVolume, FairMarketValue, FloorCount, IsBasementIncluded,
                        IsChimneyIncluded, IsPassedSmogCheck, IsSwimmingPoolIncluded, PurchaseDate, YearBuilt
                from CustomerProperty
                where createdDate = Today
        ];
        System.assert(CustomerProperties.size() == 1, 'CustomerProperties Not created');
        System.Debug(LoggingLevel.DEBUG, 'CustomerProperties:' + JSON.serialize(CustomerProperties));


        List<CoverageType> CoverageTypes = [
                Select Id, Category, CategoryGroup, CategoryGroupType, CategoryGroupTypeValue, DeductibleAmount, EffectiveDate, ExpirationDate, LimitAmount, LimitRange, Name, SourceSystemIdentifier
                from CoverageType
                where createdDate = Today
        ];
        System.assert(CoverageTypes.size() > 0, 'CoverageTypes Not created');
        System.Debug(LoggingLevel.DEBUG, 'CoverageTypes:' + JSON.serialize(CoverageTypes));

        List<InsurancePolicy> InsurancePolicies = [
                Select Id, Name
                from InsurancePolicy
                where createdDate = Today
        ];
        //System.assert(InsurancePolicies.size()>0, 'InsurancePolicies Not created');
        System.Debug(LoggingLevel.DEBUG, 'InsurancePolicies:' + JSON.serialize(InsurancePolicies));


    }

    private static testMethod void testGlobalMethod_invokeLoadFromStaticResource() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            //createNonSetupTestData();
            List<Submission__c> submisstionList = [Select Id, name, case__c from Submission__c limit 1];
            System.assert(submisstionList.size() > 0, 'Submission Record Does not Exist');
            String SubmisisonId = submisstionList[0].Id;
            System.assert(submisstionList[0].case__c != null, 'Submission case Does not Exist');


            List<StaticResource> sr = [Select id, name, body from StaticResource where Name = 'submissionrespunformatted'];
            System.assert(sr.size() > 0, 'Static Resource is not available');
            String submissionResponseJson = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr[0].body)).toString();
            System.assert(!String.isBlank(submissionResponseJson), 'JSON Response is blank');
            try {
                invokeLoadFromStaticResource(SubmisisonId);
            } catch (Exception Ex) {
                System.debug(LoggingLevel.ERROR, ex.getMessage() + ex.getCause());

            }
            List<Account> AcctList = [Select Id, name, RecordTypeId from Account where createdDate = Today];
            System.assert(AcctList.size() > 0, 'Account Not created');
            System.Debug(LoggingLevel.DEBUG, 'Accounts:' + JSON.serialize(AcctList));


            List<Claim> Claims = [Select Id, AccountId, IsDrivable, Status from Claim where createdDate = Today];
            System.assert(Claims.size() > 0, 'Claims Not created');
            System.Debug(LoggingLevel.DEBUG, 'Claims:' + JSON.serialize(Claims));

            List<CustomerProperty> CustomerProperties = [
                    Select Id, PrimaryOwnerId, FloorType, FoundationType, GarageType,
                            LotArea, CeilingType, DwellingType, PurchasePrice, RoofType, BedroomCount, BuiltUpArea, EngineDisplacementVolume, FairMarketValue, FloorCount, IsBasementIncluded,
                            IsChimneyIncluded, IsPassedSmogCheck, IsSwimmingPoolIncluded, PurchaseDate, YearBuilt
                    from CustomerProperty
                    where createdDate = Today
            ];
            System.assert(CustomerProperties.size() > 0, 'CustomerProperties Not created');
            System.Debug(LoggingLevel.DEBUG, 'CustomerProperties:' + JSON.serialize(CustomerProperties));


            List<CoverageType> CoverageTypes = [
                    Select Id, Category, CategoryGroup, CategoryGroupType, CategoryGroupTypeValue, DeductibleAmount, EffectiveDate, ExpirationDate, LimitAmount, LimitRange, Name, SourceSystemIdentifier
                    from CoverageType
                    where createdDate = Today
            ];
            System.assert(CoverageTypes.size() > 0, 'CoverageTypes Not created');
            System.Debug(LoggingLevel.DEBUG, 'CoverageTypes:' + JSON.serialize(CoverageTypes));

            List<InsurancePolicy> InsurancePolicies = [Select Id, Name from InsurancePolicy where createdDate = Today];
            System.Debug(LoggingLevel.DEBUG, 'InsurancePolicies:' + JSON.serialize(InsurancePolicies));

        }


        Test.stopTest();
    }

    public static void invokeLoadFromStaticResource(String SubmissionId) {


        StaticResource SR = [Select id, name, body from StaticResource where Name = 'submissionrespunformatted'];//cognisureapimetadata.get
        String submissionResponseJson = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr.body)).toString();
        //Delete [Select Id,name from Account where createdDate =Today];
        //Delete [Select Id,name,ActualAmount,AssessmentDate,LossDate,Status from Claim ];
        //Delete [Select Id,name,Address,format(createdDate), AnnualMileage, BuiltUpArea, CeilingType, City, ConstructionClass, Country  from CustomerProperty  ];
        // Delete [Select Id,name from WorkerCompCoverageClass  ];
        //Delete [Select Id,name from CoverageType  ];
        //Delete [Select Id,name from Account where createdDate =Today];
        //Delete [Select Id,name,ActualAmount,AssessmentDate,LossDate,Status from Claim ];
        Id submissionId0;
        submissionId0 = SubmissionId;
        if (string.isBlank(submissionId0)) {
            submissionId0 = CognisureAPI_Util.getSubmissionId();

        }
        List<Account> accountList = [Select Id, name from Account where createdDate = Today];
        System.assert(accountList.size() == 0, 'Account should not exist yet.');
        System.assert(String.isNotBlank(submissionResponseJson), 'Blank Json Response');
        System.debug(LoggingLevel.Debug, '==========' + submissionResponseJson);
        if (string.isBlank(submissionId0)) {
            System.assert(false, 'Submission Id is empty');
        }

        ProcessSubmissionResponse.processJSONResponse(submissionResponseJson, submissionId0);
    }


    private static testMethod void test_Misc() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            CognisureAPIRequestsTest.getCommonJSONAPIResponse();
            CognisureAPIRequestsTest.getCommonjsonAPIResp2();
            CognisureAPI.schedulebatchjobs();
        }
        Test.stopTest();


    }

    @TestSetup
    private static void createTestData() {
        List<PermissionSet> p = [Select id, name from PermissionSet where name = 'Cognisuire_AI'];
        System.assert(p.size() > 0, 'No permission set Cognisuire_AI');
        List<PermissionSetAssignment> permissionSetAssignment = [Select Id from PermissionSetAssignment where PermissionSetId = :p[0].Id and AssigneeId = :UserInfo.getUserId()];
        if (permissionSetAssignment.size() == 0) {
            PermissionSetAssignment pa = new PermissionSetAssignment(AssigneeId = UserInfo.getUserId(), PermissionSetId = p[0].Id);

            Insert pa;
        }
        createNonSetupTestData();
    }


    private static void createNonSetupTestData() {
        List<Sobject> cases = getCases();
        Insert cases;
        Case case0 = (case) cases[0];
        createEmailMessage(case0.Id);
        List<Sobject> submisisonList = getSubmissionList();
        submisisonList[0].put('case__c', case0.Id);
        insert submisisonList;
        CognisureAPIRequestsTest.runTestDataTest();
        //MappingDefinitionCtrl.getStaticResourceData();
    }


    private static void createEmailMessage(String caseId) {
        EmailMessage emailMessage = new EmailMessage();
        emailMessage.status = '3'; // email was sent
        emailMessage.ParentId = caseId;
        emailMessage.fromAddress = 'billing@acme.com'; // from address
        emailMessage.fromName = 'Billing Department'; // from name
        emailMessage.toAddress = 'johnSmith@example.com';
        emailMessage.Subject = 'Hello';

        emailMessage.HtmlBody = 'Hello World';
        insert emailMessage;

        Attachment obj = new Attachment();
        obj.Body = Blob.valueOf('Test Blob');
        obj.ParentId = emailMessage.Id;
        obj.Name = 'Dummy.pdf';
        obj.ContentType = 'application/pdf';
        insert obj;

        System.debug([SELECT Id, HasAttachment FROM EmailMessage WHERE Id = :emailMessage.Id]);
    }

    private static List<Sobject> getCases() {
        String caseJSON = '[\n' +
                '  {\n' +
                '    "AccountId": null,\n' +
                '    "CaseNumber": "00001044",\n' +
                '    "Description": "Attaching both the documents Thank you, myname.",\n' +
                //'    "Id": "500Hp00001fQeMTIA0",\n' +
                '    "Origin": "Email",\n' +
                '    "Priority": "Medium",\n' +
                '    "Processed_By_Cognisure__c": false,\n' +
                '    "Status": "New",\n' +
                '    "Subject": "Documents from ABC TOP CO",\n' +
                '    "SuppliedEmail": "myemail@cognisure.ai",\n' +
                '    "SuppliedName": "myname",\n' +
                '    "Type": null\n' +
                '  }\n' +
                ']';

        List<Sobject> caseList = (List<case>) JSON.deserialize(caseJSON, List<case>.class);
        return caseList;

    }

    private static String getMessageIdfromCSResponse() {
        String fileUploadResp = CognisureAPIRequestsTest.getFileUploadAPIResponse();
        Map<String, Object> m = (Map<String, Object>) JSON.deserializeUntyped(fileUploadResp);
        String response_Id = (String) m.get('id');
        return response_Id;

    }


    private static List<Sobject> getSubmissionList() {
        String SubmssionJSON = '[\n' +
                '  {\n' +
                '    "Case__c": null,\n' +
                '    "Common_JSON_Status__c": false,\n' +
                '    "Custom_JSON_Status__c": false,\n' +
                '    "Message_Id__c": "",\n' +
                '    "Submission_360_Status__c": false,\n' +
                '    "Submission_Id__c": null\n' +
                '  }\n' +
                ']';
        List<Sobject> SubmissionJSONList = (List<Submission__c>) JSON.deserialize(SubmssionJSON, List<Submission__c>.class);
        return SubmissionJSONList;
    }

    private static testmethod void testCustomSettingMapping() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            Id submissionId = [Select id, name from Submission__c limit 1].Id;
            System.assert(submissionId != null, 'Submission Id is null');
            string jsonresp = CognisureAPIRequestsTest.getCommonjsonAPIResp2();
            //ProcessSubmissionResponse_mdt.processJSONResponse('',submissionId);
            ProcessSubmissionResponse.processJSONResponse(jsonresp, submissionId);
            Account a = [Select id, name from account where CreatedDate = Today limit 1];
            System.assert(a != null, 'Account not created');
            List<Claim> claimsList = [Select id, name from Claim where createdDate = Today];
            System.assert(claimsList.size() > 0, 'Claims not created..');
        }
        Test.stopTest();

    }

    private static testMethod void testSobjectFieldDefaults() {
        Cognisureapi__mdt cognisureapimetadata = Cognisureapi__mdt.getInstance('api_details');
        StaticResource fsc_sobject_field_defaults;
        List<String> sobjectList = new List<String>{
                'Account', 'Claim'
        };
        if (fsc_sobject_field_defaults == null) {
            List<StaticResource> srList = [Select Id, name, body from StaticResource where Name = :(String) cognisureapimetadata.get('Field_Default_Definition__c')];
            if (srList.size() == 0) {
                System.assert(false, 'Field Default Definition Static Resource is not found. ');
            }
            if (srList.size() > 0) {
                fsc_sobject_field_defaults = srList[0];
            }
        }
        Schema.DescribeSObjectResult[] descResult = Schema.describeSObjects(
                new List<String>(sobjectList));
        Map<String, Schema.DescribeSObjectResult> descResMap = new Map<String, Schema.DescribeSObjectResult>();
        for (Schema.DescribeSObjectResult descResult_iter : descResult) {
            descResMap.put(descResult_iter.getName(), descResult_iter);
        }
        StaticResource Sr = fsc_sobject_field_defaults;
        String DefaultfieldMapStr = EncodingUtil.base64Decode(EncodingUtil.base64Encode(sr.body)).toString();


        for (String Sobjectname : sobjectList) {
            Schema.DescribeSObjectResult descSobjRes = descResMap.get(Sobjectname);
            Map<String, Object> DefaultfieldMapByObject = (Map<String, Object>) JSON.deserializeUntyped(DefaultfieldMapStr);
            Map<String, Object> DefaultsMap_Sobject = (Map<String, Object>) DefaultfieldMapByObject.get(Sobjectname);
            if (Sobjectname == 'Account') {
                if (DefaultfieldMapByObject.containsKey('Account')) {
                    Object accountMapObj = DefaultfieldMapByObject.get('Account');

                    Map<String, Object> accountFieldDefaultMap = (Map<String, Object>) accountMapObj;
                    if (!accountFieldDefaultMap.containsKey('Name')) {
                        System.assert(false, 'Account Name Default Does Not Exist. ');
                    } else {
                        String accountName = (String) accountFieldDefaultMap.get('Name');
                        if (String.isBlank(accountName))
                            System.assert(false, 'Account Name Default Does Not Exist. ');

                    }
                } else {
                    System.assert(false, 'Account  Default Map Does Not Exist. ');

                }
            }
            if (Sobjectname == 'Claim') {
                if (DefaultfieldMapByObject.containsKey('Claim')) {
                    Object claimMapObj = DefaultfieldMapByObject.get('Claim');

                    Map<String, Object> accountFieldDefaultMap = (Map<String, Object>) claimMapObj;
                    if (!accountFieldDefaultMap.containsKey('Name')) {
                        System.assert(false, 'Account Name Default Does Not Exist. ');
                    } else {
                        String accountName = (String) accountFieldDefaultMap.get('Name');
                        if (String.isBlank(accountName))
                            System.assert(false, 'Account Name Default Does Not Exist. ');

                    }
                } else {
                    System.debug(LoggingLevel.DEBUG, JSON.serialize(DefaultsMap_Sobject));
                    System.assert(false, 'Claim  Default Map Does Not Exist. ');

                }
            }
        }


    }

    private static testMethod void testInsertClaimRecords() {
        String claimJson = '[{"attributes":{"type":"Claim"},"Name":"Test0", "IsDrivable":"false", "Status":"Initial", "AccountId":"", "CaseId":""}]';
        List<Claim> cliams = (List<Claim>) JSON.deserialize(claimJson, List<Claim>.class);
        Insert cliams;
    }

    private static testMethod void testNameSpaceAPI() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            System.Assert.isTrue(CognisureAPI_Util.getNameSpacePrefix() != null, 'namespace prefix from method is null');
            Sobject SubsmsisonSobjRecord = [Select Id, case__c from Submission__c limit 1];

            String NAMESPACEPREFIX = CognisureAPI_Util.getNameSpacePrefix();
            System.debug(LoggingLevel.DEBUG, 'NS' + NAMESPACEPREFIX);
            String caseFieldAPI = NAMESPACEPREFIX + 'Case__c';
            System.debug(LoggingLevel.DEBUG, caseFieldAPI);
            Submission__c s = [select Id, Case__c from Submission__c limit 1];
            Schema.DescribeSObjectResult[] descResult = Schema.describeSObjects(new List<String>{
                    'Submission__c'
            });
            Schema.DescribeSObjectResult descResult0 = descResult[0];
            System.debug(LoggingLevel.Debug, descResult0.fields.getMap().get(caseFieldAPI));
            System.debug(LoggingLevel.DEBUG, JSON.serialize(descResult0));
            Schema.SobjectField fieldToken_case = descResult0.fields.getMap().get(caseFieldAPI);
            System.debug((String) s.get(fieldToken_case));
            System.Assert.isTrue(fieldToken_case != null, 'Field Token is null.');
            Schema.DescribeSObjectResult dsr = Cognisureapi__mdt.sObjectType.getDescribe();
            String namespacePrefix0 = dsr.getName().remove(dsr.getLocalName());
            System.debug(namespacePrefix0);
            System.Assert.istrue(namespacePrefix0.equals(NAMESPACEPREFIX));

            System.Assert.isTrue((String) (SubsmsisonSobjRecord.get(caseFieldAPI)) != null, 'Case Id is Blank)');
        }
        Test.stopTest();


    }

    private static testMethod void test_CaseField_AccessibleOnSubmission() {

        User u = [Select Id from User where Id = :UserInfo.getUserId()];
        System.assert(u != null, 'user not found.');

        Test.startTest();
        System.runAs(u) {
            Schema.DescribeSObjectResult[] descResult_submission = Schema.describeSObjects(new List<String>{
                    'Submission__c'
            });
            Schema.DescribeSObjectResult descRes = descResult_submission[0].getSObjectType().getDescribe();
            String namespacePrefix0 = descRes.getName().remove(descRes.getLocalName());

            if (descResult_submission[0].isAccessible() && descResult_submission[0].isQueryable()) {
                String caseFieldAPI = namespacePrefix0 + 'Case__c';
                System.debug(LoggingLevel.DEBUG, caseFieldAPI);

                Schema.SobjectField fieldToken_case = descRes.fields.getMap().get(caseFieldAPI);
                System.assert(fieldToken_case != null, 'case field token is null');

                Schema.DescribeFieldResult dfr_case = fieldToken_case.getDescribe();
                System.assert(dfr_case != null, 'case describe result  is null');
                if (dfr_case.isAccessible()) {
                    Sobject SubsmsisonSobjRecord = [Select Id, case__c from Submission__c limit 1];
                    Id caseId = SubsmsisonSobjRecord.get(caseFieldAPI) != null ? String.valueOf(SubsmsisonSobjRecord.get(caseFieldAPI)) : '';
                } else {
                    System.assert(false, 'Case field on Submission Object is Not Accessible. Check permissions');
                }

            } else {
                System.assert(false, 'Submission record is not accessible. Check permissions on Submission Object.');
            }
        }
        Test.stopTest();

    }
    /*public static void processResponseElements(String jsonResponseElement){
        String jsonResponseElement2 = '{"Insured_Nm": "Carver & Carver Plumbing Inc.","Policy_Effectivedate": "09/12/2019","Policy_Expirydate": "09/12/2020","Policy_Nbr": "40466","Amount":1000,"Amount2":1000.0}';
        JSONParser parser = JSON.createParser(jsonResponseElement2);
        while (parser.nextToken() != null) {
            if (parser.getCurrentToken() == JSONToken.FIELD_NAME) {
                System.debug(LoggingLevel.DEBUG,parser.getText());
                parser.nextToken();
                System.debug(LoggingLevel.DEBUG,parser.getText());

            }

        }
        // if(version != null && String.isNotEmpty(label)) {
        //     apiVersionToReleaseNameMap.put(version, label);
        //     version = null;
        //     label = null;
        // }

    }*/

}